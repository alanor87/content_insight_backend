"use strict";(self.webpackChunkcontent_insight_frontend=self.webpackChunkcontent_insight_frontend||[]).push([[595],{4128:function(e,t,r){r.r(t),r.d(t,{default:function(){return _}});var n=r(885),s=r(4165),i=r(5861),o=r(2791),a=r(7257),c=r(1243),l=r(4880),d=r(3473),u=r(5764),p=r(1603),j="Billing_checkoutResultMessage__HI5wo",g=r(184),v=(0,d.J)("production"===p.OB?"pk_live_51Nxd5pEafHQOYw4BCyqKCmyF3KfPhaD9jlNKBODcRTlusWqtqHS8k73scyJDagI1cwAHElCEIF4qgcbU21e7kfA700qxfZJHKU":"pk_test_51Nxd5pEafHQOYw4BGVCREVAXfGdqJ1waIwTd9TT9cWrP1dI8b9rkgaTV25WSRbVGzQFx9YcYDubV8WGF1Y0zNKYf00E2dA3E0t"),h=function(){var e=p.ZP.user.userStripeCustomerId;(0,o.useEffect)((function(){t()}),[]);var t=function(){var t=(0,i.Z)((0,s.Z)().mark((function t(){var r;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.Z.post(p._n+"/api/v1/user/customerPortal",{userStripeCustomerId:e});case 2:r=t.sent,window.location.href=r.data.portal_session_url;case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,g.jsx)("div",{children:"Redirecting to the customer portal..."})},x=function(){var e=p.ZP.user,t=e.createSubscription,r=e.getProjectById,s=p.ZP.interface.currentProjectId,i=(0,o.useState)(""),a=(0,n.Z)(i,2),c=a[0],l=a[1],d=r(s);(0,o.useEffect)((function(){t({projectId:s,projectName:(null===d||void 0===d?void 0:d.projectName)||""}).then((function(e){return l(e)}))}),[]);var j={clientSecret:c};return(0,g.jsx)("div",{id:"checkout",children:c&&(0,g.jsx)(u.EmbeddedCheckoutProvider,{stripe:v,options:j,children:(0,g.jsx)(u.EmbeddedCheckout,{})})})},f=function(){var e,t=(0,o.useState)(),r=(0,n.Z)(t,2),s=r[0],i=r[1],a=p.ZP.user,c=a.getPaymentSessionStatus,d=a.getProjectById,u=a.updateSubscriptionDataLocal,v=p.ZP.interface,h=v.currentProjectId,x=v.setCurrentProjectId,f=(0,l.TH)().search;return(0,o.useEffect)((function(){if(f){var e=new URLSearchParams(f),t=e.get("session_id"),r=e.get("projectId");if(!t||!r)return;c({session_id:t,projectId:r}).then((function(e){i(e),x(r||""),u({projectId:r,isActive:"complete"===e.status,stripeCustomerId:e.stripeCustomerId,stripeProjectSubscriptionId:e.stripeProjectSubscriptionId,lastPaid:e.lastPaid})}))}}),[f]),s?(0,g.jsxs)("div",{className:j,children:["Checkout result for project :",(0,g.jsxs)("p",{children:["Project name : ",null===(e=d(h))||void 0===e?void 0:e.projectName]}),(0,g.jsxs)("p",{children:["Project id : ",h]}),(0,g.jsxs)("p",{children:["Result :","complete"===s.status?"Payment successful":"Payment failed"]})]}):null},_=(0,a.Pi)((function(){var e,t=(0,l.$B)().path,r=p.ZP.user.getProjectById,n=p.ZP.interface.currentProjectId,s=r(n);return n?(0,g.jsxs)(l.rs,{children:[(0,g.jsx)(l.AW,{exact:!0,path:t,component:null!==s&&void 0!==s&&null!==(e=s.subscription)&&void 0!==e&&e.id?h:x}),(0,g.jsx)(l.AW,{path:"".concat(t,"/checkoutResult"),component:f})]}):(0,g.jsx)(l.l_,{to:"/projects"})}))},7797:function(e,t,r){r.r(t),r.d(t,{default:function(){return N}});var n=r(8683),s=r(7257),i=r(7837),o=r(4880),a=r(5146),c=r(1603),l="ProjectTile_projectTile__quj6f",d="ProjectTile_projectDetails__grJt9",u="ProjectTile_wrapper__v8hyE",p="ProjectTile_projectName__zn2aT",j="ProjectTile_projectDetailField__Y9KxJ",g="ProjectTile_projectControls__P+4YV",v=r(1374),h=r(184),x=(0,s.Pi)((function(e){var t=e._id,r=e.projectName,n=e.projectCreationDate,s=e.projectURL,i=e.subscription,x=e.onDelete,f=(0,o.k6)(),_=new Date(n||"").toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),m=c.ZP.interface.setCurrentProjectId;return(0,h.jsxs)("div",{className:l,children:[(0,h.jsx)("div",{className:d,onClick:function(){m(t||""),f.replace("/cabinet/settings")},children:(0,h.jsxs)("div",{className:u,children:[(0,h.jsxs)("div",{className:p,children:[r,(0,h.jsx)(v.Z,{isActive:!(null===i||void 0===i||!i.isActive),stripeMode:null===i||void 0===i?void 0:i.stripeMode})]}),(0,h.jsxs)("div",{className:j,children:["URL: ",s]}),(0,h.jsxs)("div",{className:j,children:["Created: ",_]})]})}),(0,h.jsx)("div",{className:g,children:(0,h.jsx)(a.Z,{icon:"icon_delete",text:"Delete project",onClick:function(e){x(t||"")}})})]})})),f="Projects_projectsContainer__-CySH",_="Projects_addProjectButton__lsD59",m="Projects_projectTilesWrapper__ha7Uj",w=r(2791),N=(0,s.Pi)((function(){var e=c.ZP.user.userProjects,t=c.ZP.interface,r=t.setModalType,s=t.setCurrentProjectId,o=t.setDeleteProjectId,a=t.isLoading;(0,w.useEffect)((function(){return s("")}),[]);var l=function(e){o(e),r("projectDelete")};return(0,h.jsxs)("div",{className:f,children:[(0,h.jsx)(i.zx,{icon:"icon_plus",text:"Add project",className:_,onClick:function(){r("projectCreate")}}),(0,h.jsx)("div",{className:m,children:e.length?e.map((function(e){return(0,h.jsx)(x,(0,n.Z)((0,n.Z)({},e),{},{onDelete:l}),e._id)})):"You dont have any projects yet."}),a?(0,h.jsx)(i.$j,{}):null]})}))},4054:function(e,t,r){r.r(t),r.d(t,{default:function(){return E}});var n=r(2982),s=r(4165),i=r(8683),o=r(5861),a=r(885),c=r(2791),l=r(7257),d=r(1523),u=r(7837),p=r(4193),j=r(1603),g="Settings_projectPageWrapper__x8BfJ",v="Settings_projectPage__1LYim",h="Settings_projectHeader__MfVop",x="Settings_projectPageSection__HZoTz",f="Settings_sectionHeader__7Fv+K",_="Settings_sectionContent__mfMiW",m="Settings_widgetSettings__3ZVDl",w="Settings_widgetControls__SxOnQ",N="Settings_color__oSXPk",P="Settings_range__nDO0q",b="Settings_demoWidgetWrapper__dASOJ",C="Settings_stylesWarning__X+TAn",S="Settings_knowledgeBase__rYB0Z",k="Settings_labelWrapper__AToKV",Z="Settings_clearList__ujRdJ",B="Settings_knowledgeBaseList__pqKmI",y="Settings_knowledgeBaseUploadForm__roudD",I="Settings_filesList__LJdJd",D="Settings_scriptCode__72b-w",R="Settings_buttonsWrapper__QHHgf",T="Settings_dragndropMessage__I6pO6",W=r(184),E=(0,l.Pi)((function(){var e,t,r=(0,c.useState)(),l=(0,a.Z)(r,2),E=l[0],L=l[1],A=(0,c.useState)(""),H=(0,a.Z)(A,2),z=H[0],U=H[1],F=(0,c.useState)(""),M=(0,a.Z)(F,2),K=M[0],Y=M[1],J=(0,c.useState)(""),q=(0,a.Z)(J,2),O=q[0],V=q[1],Q=(0,c.useState)(""),$=(0,a.Z)(Q,2),G=$[0],X=$[1],ee=(0,c.useState)("0"),te=(0,a.Z)(ee,2),re=te[0],ne=te[1],se=(0,c.useState)(""),ie=(0,a.Z)(se,2),oe=ie[0],ae=ie[1],ce=(0,c.useState)("0"),le=(0,a.Z)(ce,2),de=le[0],ue=le[1],pe=(0,c.useState)([]),je=(0,a.Z)(pe,2),ge=je[0],ve=je[1],he=(0,c.useState)(""),xe=(0,a.Z)(he,2),fe=xe[0],_e=xe[1],me=(0,c.useRef)(null),we=j.ZP.user,Ne=we._id,Pe=we.getProjectById,be=we.saveProjectSettings,Ce=we.ingestKnowledgeBase,Se=j.ZP.interface,ke=Se.isLoading,Ze=Se.spinnerMessage,Be=Se.currentProjectId,ye=Se.setSpinnerMessage,Ie=Se.pushNotification,De=Se.setIsLoading,Re=Se.setModalType;(0,c.useEffect)((function(){if(!ke){var e=Pe(Be);if(e){var t=e.projectName,r=e.projectURL,n=e.widgetSettings,s=n.widgetHeaderColor,i=n.widgetBackgroundColor,o=n.widgetBorderColor,a=n.widgetBorderWidth,c=n.widgetBorderRadius;L(e),U(t||""),Y(r||""),V(s||""),X(i||""),ae(o||""),ue(a||""),ne(c||"")}}}),[ke,Be]);var Te=function(){return'   <script\n    id="clarify_bot_widget"\n    data-userId="'.concat(Ne,'"\n    data-projectId="').concat(Be,'"\n    src="').concat(j._n,"/widget/getWidget?projectId=").concat(Be,'"\n    data-backendURL="').concat(j._n,'"\n   ><\/script>')},We=function(e){return function(t){switch(e){case"projectName":U(t.target.value);break;case"projectURL":Y(t.target.value);break;case"widgetHeaderColor":V(t.target.value);break;case"widgetBackgroundColor":X(t.target.value);break;case"widgetBorderColor":ae(t.target.value);break;case"widgetBorderWidth":ue(t.target.value);break;case"widgetBorderRadius":ne(t.target.value)}}},Ee=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,p.f)(z)?(0,p.r)(K)||(_e("projectURLError"),0):(_e("projectNameError"),0)){e.next=2;break}return e.abrupt("return");case 2:return _e(""),t=(0,i.Z)((0,i.Z)({},E),{},{projectName:z,projectURL:K}),De(!0),ye("Updating project metadata..."),e.next=8,be(t);case 8:De(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Le=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return De(!0),ye("Updating widget settings..."),t=(0,i.Z)((0,i.Z)({},E),{},{widgetSettings:{widgetHeaderColor:O,widgetBackgroundColor:G,widgetBorderRadius:re,widgetBorderColor:oe,widgetBorderWidth:de}}),e.next=5,be(t);case 5:De(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ae=function(e){e.preventDefault(),e.stopPropagation(),console.log("handleFilesAdd");try{for(var t,r="drop"===e.type?e.dataTransfer.files:e.target.files,s=(0,n.Z)(ge),i=0;i<r.length;i+=1)"text/plain"===r[i].type&&s.push(r[i]);ve(s),null!==me&&void 0!==me&&null!==(t=me.current)&&void 0!==t&&t.value&&(me.current.value="")}catch(fe){Ie({type:"error",message:"Error while loading files from local drive. \n"+fe.message})}},He=function(){ve([])},ze=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return De(!0),ye("Ingesting knowledge base"),t=new FormData,ge.forEach((function(e){t.append("dataFiles",e)})),t.append("projectId",(null===E||void 0===E?void 0:E._id)||""),t.append("projectName",(null===E||void 0===E?void 0:E.projectName)||""),e.next=8,Ce(t);case 8:He();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return E?(0,W.jsxs)("div",{className:g,children:[(0,W.jsx)("div",{className:h,children:(0,W.jsx)(d.rU,{to:"/cabinet/projects",style:{display:"block",width:"fit-content"},children:(0,W.jsx)(u.zx,{icon:"icon_arrow_left",text:"To projects list"})})}),(0,W.jsxs)("div",{className:v,children:[(0,W.jsxs)("div",{className:x,children:[(0,W.jsxs)("div",{className:f,children:[(0,W.jsx)("h2",{children:"Widget settings"}),(0,W.jsx)(u.zx,{disabled:ke,text:"Discard",icon:"icon_close",onClick:function(){if(E){var e=E.widgetSettings;V((null===e||void 0===e?void 0:e.widgetHeaderColor)||""),X((null===e||void 0===e?void 0:e.widgetBackgroundColor)||""),ae((null===e||void 0===e?void 0:e.widgetBorderColor)||""),ue((null===e||void 0===e?void 0:e.widgetBorderWidth)||""),ne((null===e||void 0===e?void 0:e.widgetBorderRadius)||"")}}}),(0,W.jsx)(u.zx,{disabled:ke,text:"Save",icon:"icon_save",onClick:Le})]}),(0,W.jsxs)("div",{className:_+" "+m,children:[(0,W.jsxs)("div",{className:w,children:[" ",(0,W.jsxs)("label",{className:N,children:["Header color",(0,W.jsx)("input",{type:"color",value:O,onChange:We("widgetHeaderColor")})]}),(0,W.jsxs)("label",{className:N,children:["Background color",(0,W.jsx)("input",{type:"color",value:G,onChange:We("widgetBackgroundColor")})]}),(0,W.jsxs)("label",{className:N,children:["Border color",(0,W.jsx)("input",{type:"color",value:oe,onChange:We("widgetBorderColor")})]}),(0,W.jsxs)("label",{className:P,children:["Border width, px",(0,W.jsx)("input",{type:"range",min:0,max:6,value:de,onChange:We("widgetBorderWidth")})]}),(0,W.jsxs)("label",{className:P,children:["Border radius, px",(0,W.jsx)("input",{type:"range",min:0,max:30,value:re,onChange:We("widgetBorderRadius")})]})]}),(0,W.jsxs)("div",{className:b,children:[(0,W.jsx)(u.e4,{settings:{projectId:Be,widgetHeaderColor:O,widgetBackgroundColor:G,widgetBorderRadius:re,widgetBorderColor:oe,widgetBorderWidth:de}}),E.subscription.isActive?null:(0,W.jsx)("span",{className:C,children:"Styles are applied on production only when subscription is active."})]})]})]}),(0,W.jsxs)("div",{className:x,children:[(0,W.jsxs)("div",{className:f,children:[(0,W.jsx)("h2",{children:"Knowledge base"}),(0,W.jsxs)("div",{className:R,children:[(0,W.jsx)(u.zx,{disabled:ke||!ge.length,text:"Ingest",icon:"icon_edit",onClick:ze}),(0,W.jsx)(u.zx,{disabled:ke||!(null!==E&&void 0!==E&&null!==(e=E.projectIngestedData)&&void 0!==e&&e.length),text:"Delete",icon:"icon_delete",onClick:function(){ye("Deleting knowledge base"),Re("proejctKBDelete"),He()}})]})]}),(0,W.jsxs)("div",{className:_+" "+S,children:[(0,W.jsxs)("div",{children:[(0,W.jsx)("label",{children:"List of knowledgebase files"}),(0,W.jsx)("div",{className:B,children:(0,W.jsx)("ul",{className:I,children:null===E||void 0===E||null===(t=E.projectIngestedData)||void 0===t?void 0:t.map((function(e){var t=e.fileName,r=e.size;return(0,W.jsxs)("li",{children:[(0,W.jsx)("span",{children:t}),(0,W.jsxs)("span",{children:[Number.parseFloat(r||"").toFixed(2)," kb"]})]},t)}))})})]}),(0,W.jsxs)("div",{children:[(0,W.jsxs)("label",{className:k,children:[(0,W.jsx)("span",{children:"Files to ingest"}),null!==ge&&void 0!==ge&&ge.length?(0,W.jsx)("span",{className:Z,onClick:He,children:"Clear list"}):null]}),(0,W.jsx)("input",{ref:me,type:"file",accept:".txt",multiple:!0,onChange:Ae}),(0,W.jsx)("div",{className:y,onDragOver:function(e){return e.preventDefault()},onDrop:Ae,onClick:function(){var e;return null===me||void 0===me||null===(e=me.current)||void 0===e?void 0:e.click()},children:null!==ge&&void 0!==ge&&ge.length?(0,W.jsx)("ul",{className:I,children:Array.from(ge).map((function(e){var t=e.name,r=e.size;return(0,W.jsxs)("li",{children:[(0,W.jsx)("span",{children:t}),(0,W.jsx)("span",{children:"".concat(r/1e3," kb")})]},t+r)}))}):(0,W.jsx)("div",{className:T,children:"Drag'n'drop txt files or click Add files button. Files are adding up to the ones that are already in knowledge base."})})]})]})]})," ",(0,W.jsxs)("div",{className:x,children:[(0,W.jsxs)("div",{className:f,children:[(0,W.jsx)("h2",{children:"Metadata"}),(0,W.jsx)(u.zx,{disabled:ke,text:"Discard",icon:"icon_close",onClick:function(){U((null===E||void 0===E?void 0:E.projectName)||""),Y((null===E||void 0===E?void 0:E.projectURL)||"")}}),(0,W.jsx)(u.zx,{disabled:ke,text:"Save",icon:"icon_save",onClick:Ee})]}),(0,W.jsxs)("div",{className:_,children:[(0,W.jsxs)("label",{children:["Project name",(0,W.jsx)("span",{className:"hintText",children:"leters, numbers, dashes are allowed"}),(0,W.jsx)("input",{type:"text",className:"projectNameError"===fe?"error":"",placeholder:"project-name",value:z,onChange:We("projectName")})]}),(0,W.jsxs)("label",{children:["Project URL for the widget usage",(0,W.jsx)("input",{type:"url",className:"projectURLError"===fe?"error":"",placeholder:"https://example.com",value:K,onChange:We("projectURL")})]})]})]}),(0,W.jsxs)("div",{className:x,children:[(0,W.jsxs)("div",{className:f,children:[(0,W.jsx)("h2",{children:"Client script"}),(0,W.jsx)(u.zx,{disabled:ke,text:"Copy",icon:"icon_copy",onClick:function(){window.navigator.clipboard.writeText(Te()).then((function(){return Ie({type:"info",message:"Script copied to clipboard."})}))}})]}),(0,W.jsxs)("div",{className:_,children:[(0,W.jsx)("code",{className:D,children:Te()})," "]})]}),ke?(0,W.jsx)(u.$j,{text:Ze}):null]})]}):(0,W.jsx)("div",{children:"Project not found."})}))},1895:function(e,t,r){r.r(t),r.d(t,{Billing:function(){return x.default},Projects:function(){return h.default},Settings:function(){return f.default},Stats:function(){return _},default:function(){return v}});var n=r(2791),s=r(7257),i=r(4880),o=r(7837),a=r(1603),c="Cabinet_projectTitle__mdMBP",l="Cabinet_projectName__zYEFB",d="Cabinet_projectId__6NzER",u=r(184),p=(0,n.lazy)((function(){return Promise.resolve().then(r.bind(r,7797))})),j=(0,n.lazy)((function(){return Promise.resolve().then(r.bind(r,4128))})),g=(0,n.lazy)((function(){return Promise.resolve().then(r.bind(r,4054))})),v=(0,s.Pi)((function(){var e,t,r=(0,i.$B)().url,s=(0,i.TH)().pathname,v=a.ZP.interface,h=v.currentProjectId,x=v.isLoading,f=(0,a.ZP.user.getProjectById)(h);return(0,n.useEffect)((function(){}),[x]),(0,u.jsx)("div",{className:"page",children:(0,u.jsxs)("div",{className:"pageContent",children:[f?(0,u.jsxs)("div",{className:c,children:[(0,u.jsxs)("h1",{className:l,children:["Project name : "+f.projectName,(0,u.jsx)(o.tU,{isActive:null===(e=f.subscription)||void 0===e?void 0:e.isActive,stripeMode:null===(t=f.subscription)||void 0===t?void 0:t.stripeMode})]}),(0,u.jsx)("span",{className:d,children:"Project id : "+f._id})]}):null,(0,u.jsx)(n.Suspense,{fallback:(0,u.jsx)(o.$j,{}),children:(0,u.jsxs)(i.rs,{children:[(0,u.jsx)(i.l_,{from:"/:url*(/+)",to:s.slice(0,-1)})," ",(0,u.jsx)(i.AW,{path:"".concat(r,"/projects"),component:p}),(0,u.jsx)(i.AW,{path:"".concat(r,"/billing"),component:j}),(0,u.jsx)(i.AW,{path:"".concat(r,"/settings"),component:g}),(0,u.jsx)(i.l_,{to:"".concat(r,"/projects")})," "]})})]})})})),h=r(7797),x=r(4128),f=r(4054),_=function(){return(0,u.jsx)("div",{children:"Stats."})}}}]);
//# sourceMappingURL=Cabinet.8b1aa3dc.chunk.js.map
"use strict";(self.webpackChunkcontent_insight_frontend=self.webpackChunkcontent_insight_frontend||[]).push([[595],{889:function(e,t,n){n.r(t),n.d(t,{default:function(){return s}});var r=n(184),s=function(){return(0,r.jsx)("div",{children:"Billing."})}},444:function(e,t,n){n.r(t),n.d(t,{default:function(){return $}});var r=n(257),s=n(880),c=n(683),a=n(165);function i(e,t,n,r,s,c,a){try{var i=e[c](a),o=i.value}catch(l){return void n(l)}i.done?t(o):Promise.resolve(o).then(r,s)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var c=e.apply(t,n);function a(e){i(c,r,s,a,o,"next",e)}function o(e){i(c,r,s,a,o,"throw",e)}a(void 0)}))}}var l=n(791),d=n(397),u=n(523),p=n(253),j="ProjectTile_projectTile__quj6f",h="ProjectTile_projectDetails__grJt9",f="ProjectTile_projectName__zn2aT",x="ProjectTile_projectURL__QeNpF",v="ProjectTile_projectControls__P+4YV",_=n(184),g=function(e){var t=e._id,n=e.projectName,r=e.projectCreationDate,c=e.projectURL,a=e.onDelete,i=(0,s.$B)().url;return(0,_.jsxs)("div",{className:j,children:[(0,_.jsxs)("div",{className:h,children:[" ",(0,_.jsxs)(u.rU,{to:"".concat(i,"/").concat(t),children:[(0,_.jsx)("div",{className:f,children:n}),(0,_.jsxs)("div",{className:x,children:["URL: ",c]}),(0,_.jsxs)("div",{className:x,children:["Created: ",r]})]})]}),(0,_.jsx)("div",{className:v,children:(0,_.jsx)(p.Z,{icon:"icon_delete",text:"Delete project",onClick:function(){a(t)}})})]})},m=(0,l.memo)(g),P=n(863),N="ProjectsList_projectsContainer__q0Cj8",w="ProjectsList_addProjectButton__pAUz0",b="ProjectsList_projectTilesWrapper__BioBg",y=(0,r.Pi)((function(){var e=(0,l.useRef)(null),t=P.Z.user,n=t.userProjects,r=t.createProject,s=t.deleteProject,i=function(){var e=o((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=o((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,_.jsxs)("div",{className:N,children:[(0,_.jsx)(d.zx,{icon:"icon_plus",text:"Add project",className:w,onClick:function(){e.current.showModal()}}),(0,_.jsx)("div",{className:b,children:n.length?n.map((function(e){return(0,_.jsx)(m,(0,c.Z)((0,c.Z)({},e),{},{onDelete:u}),e._id)})):"You dont have any projects yet."}),(0,_.jsx)("dialog",{ref:e,children:(0,_.jsx)(d.hK,{onCreateClick:i,onCloseClick:function(){e.current.close()}})})]})})),k=n(982),C=n(885),Z="ProjectPage_projectPageWrapper__DfPKp",L="ProjectPage_projectPage__gPfMH",U="ProjectPage_projectHeader__Npbm9",D="ProjectPage_settings__O-GlV",R="ProjectPage_knowledgeBase__pVuHl",B="ProjectPage_knowledgeBaseList__HxEv1",S="ProjectPage_knowledgeBaseUploadForm__k82B2",z="ProjectPage_projectPageSection__BaH67",I="ProjectPage_sectionHeader__8KMsL",T="ProjectPage_sectionContent__WjGjw",W="ProjectPage_scriptCode__YCQon",A="ProjectPage_buttonsWrapper__uchQ+",E="ProjectPage_dragndropMessage__cuePI",F="ProjectPage_filesList__qlSQN",H=n(961),K=(0,r.Pi)((function(){var e=(0,s.UO)().id,t=(0,l.useState)(),n=(0,C.Z)(t,2),r=n[0],i=n[1],p=(0,l.useState)(""),j=(0,C.Z)(p,2),h=j[0],f=j[1],x=(0,l.useState)(""),v=(0,C.Z)(x,2),g=v[0],m=v[1],N=(0,l.useState)(!1),w=(0,C.Z)(N,2),b=w[0],y=w[1],K=(0,l.useState)([]),M=(0,C.Z)(K,2),$=M[0],Q=M[1],q=(0,l.useState)(""),O=(0,C.Z)(q,2),V=O[0],Y=O[1],G=(0,l.useState)(""),J=(0,C.Z)(G,2),X=J[0],ee=J[1],te=P.Z.user,ne=te.getProjectById,re=te.saveProjectMetadata,se=te.ingestKnowledgeBase,ce=te.deleteKnowledgeBase,ae=te._id,ie=P.Z.interface.pushNotification,oe=ne(e);(0,l.useEffect)((function(){oe&&(i(oe),f(oe.projectURL),m(oe.widgetURL))}),[oe]);var le=function(e){return function(t){switch(e){case"projectURL":f(t.target.value);break;case"widgetURL":m(t.target.value)}}},de=function(){var e=o((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,H.Z)(h)||(ee("projectURLError"),0)){e.next=2;break}return e.abrupt("return");case 2:return ee(""),t=(0,c.Z)((0,c.Z)({},r),{},{projectURL:h,widgetURL:g}),y(!0),Y("Updating project metadata"),e.next=8,re(t);case 8:y(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ue=function(e){console.log("handleFilesAdd"),e.preventDefault(),e.stopPropagation();try{for(var t="drop"===e.type?e.dataTransfer.files:e.target.files,n=(0,k.Z)($),r=0;r<t.length;r+=1)"text/plain"===t[r].type&&n.push(t[r]);Q(n)}catch(X){ie({type:"error",message:"Error while loading files from local drive. \n"+X.message})}},pe=function(){var e=o((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),Y("Ingesting knowledge base"),t=new FormData,$.forEach((function(e){t.append("dataFiles",e)})),t.append("projectId",(null===r||void 0===r?void 0:r._id)||""),t.append("projectName",(null===r||void 0===r?void 0:r.projectName)||""),e.next=8,se(t);case 8:Q([]),y(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),je=function(){var e=o((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),Y("Deleting knowledge base"),e.next=4,ce((null===r||void 0===r?void 0:r._id)||"",(null===r||void 0===r?void 0:r.projectName)||"");case 4:Q([]),y(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=function(){return'   <script\n       id="content_insight_widget"\n       data-userId="'.concat(ae,'"\n       data-projectId="').concat(e,'"\n       src="http://localhost:3300/widget"\n       data-completionsURL="http://localhost:3300/api/v1/getCompletion"\n   ><\/script>')};return r?(0,_.jsxs)("div",{className:Z,children:[(0,_.jsxs)("div",{className:U,children:[(0,_.jsxs)("h1",{children:["Project : ",r.projectName]})," ",(0,_.jsx)(u.rU,{to:"/cabinet/projects",style:{display:"block",width:"fit-content"},children:(0,_.jsx)(d.zx,{icon:"icon_arrow_left",text:"To projects list"})})]}),(0,_.jsxs)("div",{className:L,children:[(0,_.jsxs)("div",{className:D,children:[(0,_.jsxs)("div",{className:z,children:[(0,_.jsxs)("div",{className:I,children:[(0,_.jsx)("h2",{children:"Client script"}),(0,_.jsx)(d.zx,{disabled:b,text:"Copy script",icon:"icon_copy",onClick:function(){window.navigator.clipboard.writeText(he()).then((function(){return ie({type:"info",message:"Script copied to clipboard."})}))}})]}),(0,_.jsx)("div",{className:T,children:(0,_.jsx)("code",{className:W,children:he()})})]}),(0,_.jsxs)("div",{className:z,children:[(0,_.jsxs)("div",{className:I,children:[(0,_.jsx)("h2",{children:"Metadata "}),(0,_.jsx)(d.zx,{disabled:b,text:"Save metadata",icon:"icon_save",onClick:de})]}),(0,_.jsxs)("div",{className:T,children:[(0,_.jsxs)("label",{children:["Project URL for the widget usage",(0,_.jsx)("input",{type:"url",className:"projectURLError"===X?"error":"",placeholder:"https://example.com",value:h,onChange:le("projectURL")})]}),(0,_.jsxs)("label",{children:["Widget source URL",(0,_.jsx)("input",{type:"url",className:"projectURLError"===X?"error":"",placeholder:"https://example.com",value:g,onChange:le("widgetURL")})]})]})]})]}),(0,_.jsx)("div",{className:R,children:(0,_.jsxs)("div",{className:z,children:[(0,_.jsxs)("div",{className:I,children:[(0,_.jsx)("h2",{children:"Knowledge base"}),(0,_.jsxs)("div",{className:A,children:[(0,_.jsx)(d.zx,{disabled:b||!$.length,text:"Ingest",icon:"icon_edit",onClick:pe}),(0,_.jsx)(d.zx,{disabled:b||!r.projectIngestedData.length,text:"Delete",icon:"icon_delete",onClick:je})]})]}),(0,_.jsxs)("div",{className:T,children:[(0,_.jsxs)("details",{open:!!r.projectIngestedData.length,children:[(0,_.jsx)("summary",{children:"List of knowledgebase files"}),(0,_.jsx)("div",{className:B,children:(0,_.jsx)("ul",{className:F,children:r.projectIngestedData.map((function(e){var t=e.fileName,n=e.size;return(0,_.jsxs)("li",{children:[(0,_.jsx)("span",{children:t}),(0,_.jsxs)("span",{children:[Number.parseFloat(n).toFixed(2)," kb"]})]},t)}))})})]}),(0,_.jsxs)("details",{open:!r.projectIngestedData.length,children:[(0,_.jsx)("summary",{children:"Ingest files"}),(0,_.jsxs)("div",{className:S,onDragOver:function(e){e.preventDefault(),e.stopPropagation()},children:[null!==$&&void 0!==$&&$.length?(0,_.jsx)("ul",{className:F,children:Array.from($).map((function(e){var t=e.name,n=e.size;return(0,_.jsxs)("li",{children:[(0,_.jsx)("span",{children:t}),(0,_.jsx)("span",{children:n})]},t+n)}))}):(0,_.jsx)("div",{className:E,children:"Drag'n'drop txt files or click the area for dialog window. Files are adding up to the ones that are already in knowledge base."}),(0,_.jsx)("input",{type:"file",accept:".txt",multiple:!0,onDragEnd:ue,onChange:ue})]})]})]})]})}),b?(0,_.jsx)(d.$j,{text:V}):null]})]}):(0,_.jsx)("div",{children:"Project not found."})})),M={},$=(0,r.Pi)((function(){var e=(0,s.$B)().url;return(0,_.jsxs)("div",{className:M.projects,children:[" ",(0,_.jsxs)(s.rs,{children:[(0,_.jsx)(s.AW,{exact:!0,path:"".concat(e),component:y}),(0,_.jsx)(s.AW,{path:"".concat(e,"/:id"),component:K})]})]})}))},796:function(e,t,n){n.r(t),n.d(t,{default:function(){return s}});var r=n(184),s=function(){return(0,r.jsx)("div",{children:"Settings."})}},346:function(e,t,n){n.r(t),n.d(t,{default:function(){return s}});var r=n(184),s=function(){return(0,r.jsx)("div",{children:"Stats."})}},266:function(e,t,n){n.r(t),n.d(t,{Billing:function(){return f.default},Projects:function(){return h.default},Settings:function(){return x.default},Stats:function(){return v.default},default:function(){return j}});var r=n(791),s=n(880),c=n(397),a="Cabinet_cabinet__ohff-",i="Cabinet_cabinetPageContent__xyzny",o=n(184),l=(0,r.lazy)((function(){return Promise.resolve().then(n.bind(n,444))})),d=(0,r.lazy)((function(){return Promise.resolve().then(n.bind(n,889))})),u=(0,r.lazy)((function(){return Promise.resolve().then(n.bind(n,796))})),p=(0,r.lazy)((function(){return Promise.resolve().then(n.bind(n,346))})),j=function(){var e=(0,s.$B)().url,t=(0,s.TH)().pathname;return(0,o.jsx)("div",{className:a,children:(0,o.jsx)("div",{className:i,children:(0,o.jsx)(r.Suspense,{fallback:(0,o.jsx)(c.$j,{}),children:(0,o.jsxs)(s.rs,{children:[(0,o.jsx)(s.l_,{from:"/:url*(/+)",to:t.slice(0,-1)}),(0,o.jsx)(s.AW,{path:"".concat(e,"/projects"),component:l}),(0,o.jsx)(s.AW,{path:"".concat(e,"/stats"),component:p}),(0,o.jsx)(s.AW,{path:"".concat(e,"/billing"),component:d}),(0,o.jsx)(s.AW,{path:"".concat(e,"/settings"),component:u}),(0,o.jsx)(s.AW,{exact:!0,path:"".concat(e,"/"),component:function(){return(0,o.jsx)(s.l_,{to:"".concat(e,"/projects")})}})]})})})})},h=n(444),f=n(889),x=n(796),v=n(346)}}]);
//# sourceMappingURL=Cabinet.5b4cb966.chunk.js.map
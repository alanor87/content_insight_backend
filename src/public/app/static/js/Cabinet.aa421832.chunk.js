"use strict";(self.webpackChunkcontent_insight_frontend=self.webpackChunkcontent_insight_frontend||[]).push([[595],{889:function(e,t,n){n.r(t),n.d(t,{default:function(){return c}});var r=n(184),c=function(){return(0,r.jsx)("div",{children:"Billing."})}},444:function(e,t,n){n.r(t),n.d(t,{default:function(){return $}});var r=n(257),c=n(880),s=n(683),a=n(165);function o(e,t,n,r,c,s,a){try{var o=e[s](a),i=o.value}catch(l){return void n(l)}o.done?t(i):Promise.resolve(i).then(r,c)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,c){var s=e.apply(t,n);function a(e){o(s,r,c,a,i,"next",e)}function i(e){o(s,r,c,a,i,"throw",e)}a(void 0)}))}}var l=n(791),d=n(999),u=n(523),p=n(146),j="ProjectTile_projectTile__quj6f",h="ProjectTile_projectDetails__grJt9",x="ProjectTile_projectName__zn2aT",f="ProjectTile_projectURL__QeNpF",v="ProjectTile_projectControls__P+4YV",m=n(184),g=function(e){var t=e._id,n=e.projectName,r=e.projectCreationDate,s=e.projectURL,a=e.onDelete,o=(0,c.$B)().url;return(0,m.jsxs)("div",{className:j,children:[(0,m.jsxs)("div",{className:h,children:[" ",(0,m.jsxs)(u.rU,{to:"".concat(o,"/").concat(t),children:[(0,m.jsx)("div",{className:x,children:n}),(0,m.jsxs)("div",{className:f,children:["URL: ",s]}),(0,m.jsxs)("div",{className:f,children:["Created: ",r]})]})]}),(0,m.jsx)("div",{className:v,children:(0,m.jsx)(p.Z,{icon:"icon_delete",text:"Delete project",onClick:function(){a(t)}})})]})},_=(0,l.memo)(g),P=n(863),N="ProjectsList_projectsContainer__q0Cj8",w="ProjectsList_addProjectButton__pAUz0",b="ProjectsList_projectTilesWrapper__BioBg",k=(0,r.Pi)((function(){var e=(0,l.useRef)(null),t=P.Z.user,n=t.userProjects,r=t.createProject,c=t.deleteProject,o=function(){var e=i((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=i((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,m.jsxs)("div",{className:N,children:[(0,m.jsx)(d.zx,{icon:"icon_plus",text:"Add project",className:w,onClick:function(){e.current.showModal()}}),(0,m.jsx)("div",{className:b,children:n.length?n.map((function(e){return(0,m.jsx)(_,(0,s.Z)((0,s.Z)({},e),{},{onDelete:u}),e._id)})):"You dont have any projects yet."}),(0,m.jsx)("dialog",{ref:e,children:(0,m.jsx)(d.hK,{onCreateClick:o,onCloseClick:function(){e.current.close()}})})]})})),y=n(982),C=n(885),L="ProjectPage_projectPageWrapper__DfPKp",Z="ProjectPage_projectPage__gPfMH",U="ProjectPage_projectHeader__Npbm9",R="ProjectPage_settings__O-GlV",D="ProjectPage_knowledgeBase__pVuHl",S="ProjectPage_knowledgeBaseList__HxEv1",B="ProjectPage_knowledgeBaseUploadForm__k82B2",z="ProjectPage_projectPageSection__BaH67",T="ProjectPage_sectionHeader__8KMsL",I="ProjectPage_sectionContent__WjGjw",W="ProjectPage_scriptCode__YCQon",A="ProjectPage_buttonsWrapper__uchQ+",E="ProjectPage_dragndropMessage__cuePI",F="ProjectPage_filesList__qlSQN",H=n(193),K=(0,r.Pi)((function(){var e=(0,c.UO)().id,t=(0,l.useState)(),n=(0,C.Z)(t,2),r=n[0],o=n[1],p=(0,l.useState)(""),j=(0,C.Z)(p,2),h=j[0],x=j[1],f=(0,l.useState)(""),v=(0,C.Z)(f,2),g=v[0],_=v[1],N=(0,l.useState)(""),w=(0,C.Z)(N,2),b=w[0],k=w[1],K=(0,l.useState)(!1),M=(0,C.Z)(K,2),$=M[0],Q=M[1],q=(0,l.useState)([]),O=(0,C.Z)(q,2),V=O[0],Y=O[1],G=(0,l.useState)(""),J=(0,C.Z)(G,2),X=J[0],ee=J[1],te=(0,l.useState)(""),ne=(0,C.Z)(te,2),re=ne[0],ce=ne[1],se=P.Z.user,ae=se.getProjectById,oe=se.saveProjectMetadata,ie=se.ingestKnowledgeBase,le=se.deleteKnowledgeBase,de=se._id,ue=P.Z.interface.pushNotification,pe=ae(e);(0,l.useEffect)((function(){pe&&(o(pe),x(pe.projectName),_(pe.projectURL),k(pe.widgetURL))}),[pe]);var je=function(e){return function(t){switch(e){case"projectName":x(t.target.value);break;case"projectURL":_(t.target.value);break;case"widgetURL":k(t.target.value)}}},he=function(){var e=i((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,H.f)(h)?(0,H.r)(g)?(0,H.r)(b)||(ce("widgetURLError"),0):(ce("projectURLError"),0):(ce("projectNameError"),0)){e.next=2;break}return e.abrupt("return");case 2:return ce(""),t=(0,s.Z)((0,s.Z)({},r),{},{projectName:h,projectURL:g,widgetURL:b}),Q(!0),ee("Updating project metadata"),e.next=8,oe(t);case 8:Q(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xe=function(e){console.log("handleFilesAdd"),e.preventDefault(),e.stopPropagation();try{for(var t="drop"===e.type?e.dataTransfer.files:e.target.files,n=(0,y.Z)(V),r=0;r<t.length;r+=1)"text/plain"===t[r].type&&n.push(t[r]);Y(n)}catch(re){ue({type:"error",message:"Error while loading files from local drive. \n"+re.message})}},fe=function(){var e=i((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Q(!0),ee("Ingesting knowledge base"),t=new FormData,V.forEach((function(e){t.append("dataFiles",e)})),t.append("projectId",(null===r||void 0===r?void 0:r._id)||""),t.append("projectName",(null===r||void 0===r?void 0:r.projectName)||""),e.next=8,ie(t);case 8:Y([]),Q(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ve=function(){var e=i((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Q(!0),ee("Deleting knowledge base"),e.next=4,le((null===r||void 0===r?void 0:r._id)||"",(null===r||void 0===r?void 0:r.projectName)||"");case 4:Y([]),Q(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),me=function(){return'   <script\n    id="content_insight_widget"\n    data-userId="'.concat(de,'"\n    data-projectId="').concat(e,'"\n    src="').concat(b,'"\n    data-completionsURL="https://content-insight-backend-c244a3d2147a.herokuapp.com/api/v1/getCompletion"\n   ><\/script>')};return r?(0,m.jsxs)("div",{className:L,children:[(0,m.jsxs)("div",{className:U,children:[(0,m.jsxs)("h1",{children:["Project : ",r.projectName]})," ",(0,m.jsx)(u.rU,{to:"/cabinet/projects",style:{display:"block",width:"fit-content"},children:(0,m.jsx)(d.zx,{icon:"icon_arrow_left",text:"To projects list"})})]}),(0,m.jsxs)("div",{className:Z,children:[(0,m.jsxs)("div",{className:R,children:[(0,m.jsxs)("div",{className:z,children:[(0,m.jsxs)("div",{className:T,children:[(0,m.jsx)("h2",{children:"Client script"}),(0,m.jsx)(d.zx,{disabled:$,text:"Copy",icon:"icon_copy",onClick:function(){window.navigator.clipboard.writeText(me()).then((function(){return ue({type:"info",message:"Script copied to clipboard."})}))}})]}),(0,m.jsx)("div",{className:I,children:(0,m.jsx)("code",{className:W,children:me()})})]}),(0,m.jsxs)("div",{className:z,children:[(0,m.jsxs)("div",{className:T,children:[(0,m.jsx)("h2",{children:"Metadata"}),(0,m.jsx)(d.zx,{disabled:$,text:"Discard",icon:"icon_close",onClick:function(){x((null===r||void 0===r?void 0:r.projectName)||""),_((null===r||void 0===r?void 0:r.projectURL)||""),k((null===r||void 0===r?void 0:r.widgetURL)||"")}}),(0,m.jsx)(d.zx,{disabled:$,text:"Save",icon:"icon_save",onClick:he})]}),(0,m.jsxs)("div",{className:I,children:[(0,m.jsxs)("label",{children:["Project name ",(0,m.jsx)("span",{className:"hintText",children:"leters, numbers, dashes are allowed"}),(0,m.jsx)("input",{type:"text",className:"projectNameError"===re?"error":"",placeholder:"project-name",value:h,onChange:je("projectName")})]}),(0,m.jsxs)("label",{children:["Project URL for the widget usage",(0,m.jsx)("input",{type:"url",className:"projectURLError"===re?"error":"",placeholder:"https://example.com",value:g,onChange:je("projectURL")})]}),(0,m.jsxs)("label",{children:["Widget source URL",(0,m.jsx)("input",{type:"url",className:"widgetURLError"===re?"error":"",placeholder:"https://example.com",value:b,onChange:je("widgetURL")})]})]})]})]}),(0,m.jsx)("div",{className:D,children:(0,m.jsxs)("div",{className:z,children:[(0,m.jsxs)("div",{className:T,children:[(0,m.jsx)("h2",{children:"Knowledge base"}),(0,m.jsxs)("div",{className:A,children:[(0,m.jsx)(d.zx,{disabled:$||!V.length,text:"Ingest",icon:"icon_edit",onClick:fe}),(0,m.jsx)(d.zx,{disabled:$||!r.projectIngestedData.length,text:"Delete",icon:"icon_delete",onClick:ve})]})]}),(0,m.jsxs)("div",{className:I,children:[(0,m.jsxs)("details",{open:!!r.projectIngestedData.length,children:[(0,m.jsx)("summary",{children:"List of knowledgebase files"}),(0,m.jsx)("div",{className:S,children:(0,m.jsx)("ul",{className:F,children:r.projectIngestedData.map((function(e){var t=e.fileName,n=e.size;return(0,m.jsxs)("li",{children:[(0,m.jsx)("span",{children:t}),(0,m.jsxs)("span",{children:[Number.parseFloat(n).toFixed(2)," kb"]})]},t)}))})})]}),(0,m.jsxs)("details",{open:!r.projectIngestedData.length,children:[(0,m.jsx)("summary",{children:"Ingest files"}),(0,m.jsxs)("div",{className:B,onDragOver:function(e){e.preventDefault(),e.stopPropagation()},children:[null!==V&&void 0!==V&&V.length?(0,m.jsx)("ul",{className:F,children:Array.from(V).map((function(e){var t=e.name,n=e.size;return(0,m.jsxs)("li",{children:[(0,m.jsx)("span",{children:t}),(0,m.jsx)("span",{children:n})]},t+n)}))}):(0,m.jsx)("div",{className:E,children:"Drag'n'drop txt files or click the area for dialog window. Files are adding up to the ones that are already in knowledge base."}),(0,m.jsx)("input",{type:"file",accept:".txt",multiple:!0,onDragEnd:xe,onChange:xe})]})]})]})]})}),$?(0,m.jsx)(d.$j,{text:X}):null]})]}):(0,m.jsx)("div",{children:"Project not found."})})),M={},$=(0,r.Pi)((function(){var e=(0,c.$B)().url;return(0,m.jsxs)("div",{className:M.projects,children:[" ",(0,m.jsxs)(c.rs,{children:[(0,m.jsx)(c.AW,{exact:!0,path:"".concat(e),component:k}),(0,m.jsx)(c.AW,{path:"".concat(e,"/:id"),component:K})]})]})}))},796:function(e,t,n){n.r(t),n.d(t,{default:function(){return c}});var r=n(184),c=function(){return(0,r.jsx)("div",{children:"Settings."})}},346:function(e,t,n){n.r(t),n.d(t,{default:function(){return c}});var r=n(184),c=function(){return(0,r.jsx)("div",{children:"Stats."})}},521:function(e,t,n){n.r(t),n.d(t,{Billing:function(){return j.default},Projects:function(){return p.default},Settings:function(){return h.default},Stats:function(){return x.default},default:function(){return u}});var r=n(791),c=n(880),s=n(999),a=n(184),o=(0,r.lazy)((function(){return Promise.resolve().then(n.bind(n,444))})),i=(0,r.lazy)((function(){return Promise.resolve().then(n.bind(n,889))})),l=(0,r.lazy)((function(){return Promise.resolve().then(n.bind(n,796))})),d=(0,r.lazy)((function(){return Promise.resolve().then(n.bind(n,346))})),u=function(){var e=(0,c.$B)().url,t=(0,c.TH)().pathname;return(0,a.jsx)("div",{className:"page",children:(0,a.jsx)("div",{className:"pageContent",children:(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)(s.$j,{}),children:(0,a.jsxs)(c.rs,{children:[(0,a.jsx)(c.l_,{from:"/:url*(/+)",to:t.slice(0,-1)}),(0,a.jsx)(c.AW,{path:"".concat(e,"/projects"),component:o}),(0,a.jsx)(c.AW,{path:"".concat(e,"/stats"),component:d}),(0,a.jsx)(c.AW,{path:"".concat(e,"/billing"),component:i}),(0,a.jsx)(c.AW,{path:"".concat(e,"/settings"),component:l}),(0,a.jsx)(c.AW,{exact:!0,path:"".concat(e,"/"),component:function(){return(0,a.jsx)(c.l_,{to:"".concat(e,"/projects")})}})]})})})})},p=n(444),j=n(889),h=n(796),x=n(346)}}]);
//# sourceMappingURL=Cabinet.aa421832.chunk.js.map
"use strict";(self.webpackChunkcontent_insight_frontend=self.webpackChunkcontent_insight_frontend||[]).push([[595],{4128:function(e,t,r){r.r(t),r.d(t,{default:function(){return _}});var n=r(885),i=r(4165),s=r(5861),o=r(2791),a=r(7257),c=r(1243),d=r(4880),l=r(3473),u=r(5764),p=r(1603),j="Billing_checkoutResultMessage__HI5wo",g=r(184),v=(0,l.J)("production"===p.OB?"pk_live_51Nxd5pEafHQOYw4BCyqKCmyF3KfPhaD9jlNKBODcRTlusWqtqHS8k73scyJDagI1cwAHElCEIF4qgcbU21e7kfA700qxfZJHKU":"pk_test_51Nxd5pEafHQOYw4BGVCREVAXfGdqJ1waIwTd9TT9cWrP1dI8b9rkgaTV25WSRbVGzQFx9YcYDubV8WGF1Y0zNKYf00E2dA3E0t"),h=function(){var e=p.ZP.user.userStripeCustomerId;(0,o.useEffect)((function(){t()}),[]);var t=function(){var t=(0,s.Z)((0,i.Z)().mark((function t(){var r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.Z.post(p._n+"/api/v1/user/customerPortal",{userStripeCustomerId:e});case 2:r=t.sent,window.location.href=r.data.portal_session_url;case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,g.jsx)("div",{children:"Redirecting to the customer portal..."})},x=function(){var e=p.ZP.user,t=e.createSubscription,r=e.getProjectById,i=p.ZP.interface.currentProjectId,s=(0,o.useState)(""),a=(0,n.Z)(s,2),c=a[0],d=a[1],l=r(i);(0,o.useEffect)((function(){t({projectId:i,projectName:(null===l||void 0===l?void 0:l.projectName)||""}).then((function(e){return d(e)}))}),[]);var j={clientSecret:c};return(0,g.jsx)("div",{id:"checkout",children:c&&(0,g.jsx)(u.EmbeddedCheckoutProvider,{stripe:v,options:j,children:(0,g.jsx)(u.EmbeddedCheckout,{})})})},f=function(){var e,t=(0,o.useState)(),r=(0,n.Z)(t,2),i=r[0],s=r[1],a=p.ZP.user,c=a.getPaymentSessionStatus,l=a.getProjectById,u=a.updateSubscriptionDataLocal,v=p.ZP.interface,h=v.currentProjectId,x=v.setCurrentProjectId,f=(0,d.TH)().search;return(0,o.useEffect)((function(){if(f){var e=new URLSearchParams(f),t=e.get("session_id"),r=e.get("projectId");if(!t||!r)return;c({session_id:t,projectId:r}).then((function(e){s(e),x(r||""),u({projectId:r,isActive:"complete"===e.status,stripeCustomerId:e.stripeCustomerId,stripeProjectSubscriptionId:e.stripeProjectSubscriptionId,lastPaid:e.lastPaid})}))}}),[f]),i?(0,g.jsxs)("div",{className:j,children:["Checkout result for project :",(0,g.jsxs)("p",{children:["Project name : ",null===(e=l(h))||void 0===e?void 0:e.projectName]}),(0,g.jsxs)("p",{children:["Project id : ",h]}),(0,g.jsxs)("p",{children:["Result :","complete"===i.status?"Payment successful":"Payment failed"]})]}):null},_=(0,a.Pi)((function(){var e,t=(0,d.$B)().path,r=p.ZP.user.getProjectById,n=p.ZP.interface.currentProjectId,i=r(n);return n?(0,g.jsxs)(d.rs,{children:[(0,g.jsx)(d.AW,{exact:!0,path:t,component:null!==i&&void 0!==i&&null!==(e=i.subscription)&&void 0!==e&&e.id?h:x}),(0,g.jsx)(d.AW,{path:"".concat(t,"/checkoutResult"),component:f})]}):(0,g.jsx)(d.l_,{to:"/projects"})}))},7797:function(e,t,r){r.r(t),r.d(t,{default:function(){return P}});var n=r(8683),i=r(7257),s=r(7837),o=r(4880),a=r(5146),c=r(1603),d="ProjectTile_projectTile__quj6f",l="ProjectTile_projectDetails__grJt9",u="ProjectTile_wrapper__v8hyE",p="ProjectTile_projectName__zn2aT",j="ProjectTile_projectDetailField__Y9KxJ",g="ProjectTile_projectControls__P+4YV",v=r(1374),h=r(184),x=(0,i.Pi)((function(e){var t=e._id,r=e.projectName,n=e.projectCreationDate,i=e.projectURL,s=e.subscription,x=e.onDelete,f=(0,o.k6)(),_=new Date(n||"").toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),m=c.ZP.interface.setCurrentProjectId;return(0,h.jsxs)("div",{className:d,children:[(0,h.jsx)("div",{className:l,onClick:function(){m(t||""),f.replace("/cabinet/settings")},children:(0,h.jsxs)("div",{className:u,children:[(0,h.jsxs)("div",{className:p,children:[r,(0,h.jsx)(v.Z,{isActive:!(null===s||void 0===s||!s.isActive),stripeMode:null===s||void 0===s?void 0:s.stripeMode})]}),(0,h.jsxs)("div",{className:j,children:["URL: ",i]}),(0,h.jsxs)("div",{className:j,children:["Created: ",_]})]})}),(0,h.jsx)("div",{className:g,children:(0,h.jsx)(a.Z,{icon:"icon_delete",text:"Delete project",onClick:function(e){x(t||"")}})})]})})),f="Projects_projectsContainer__-CySH",_="Projects_addProjectButton__lsD59",m="Projects_projectTilesWrapper__ha7Uj",w=r(2791),P=(0,i.Pi)((function(){var e=c.ZP.user.userProjects,t=c.ZP.interface,r=t.setModalType,i=t.setCurrentProjectId,o=t.setDeleteProjectId,a=t.isLoading;(0,w.useEffect)((function(){return i("")}),[]);var d=function(e){o(e),r("projectDelete")};return(0,h.jsxs)("div",{className:f,children:[(0,h.jsx)(s.zx,{icon:"icon_plus",text:"Add project",className:_,onClick:function(){r("projectCreate")}}),(0,h.jsx)("div",{className:m,children:e.length?e.map((function(e){return(0,h.jsx)(x,(0,n.Z)((0,n.Z)({},e),{},{onDelete:d}),e._id)})):"You dont have any projects yet."}),a?(0,h.jsx)(s.$j,{}):null]})}))},4054:function(e,t,r){r.r(t),r.d(t,{default:function(){return E}});var n=r(2982),i=r(4165),s=r(8683),o=r(5861),a=r(885),c=r(2791),d=r(7257),l=r(1523),u=r(7837),p=r(4193),j=r(1603),g="Settings_projectPageWrapper__x8BfJ",v="Settings_projectPage__1LYim",h="Settings_projectHeader__MfVop",x="Settings_projectPageSection__HZoTz",f="Settings_sectionHeader__7Fv+K",_="Settings_sectionContent__mfMiW",m="Settings_widgetSettings__3ZVDl",w="Settings_widgetControls__SxOnQ",P="Settings_color__oSXPk",N="Settings_range__nDO0q",C="Settings_demoWidgetWrapper__dASOJ",b="Settings_knowledgeBase__rYB0Z",S="Settings_labelWrapper__AToKV",k="Settings_clearList__ujRdJ",Z="Settings_knowledgeBaseList__pqKmI",B="Settings_knowledgeBaseUploadForm__roudD",y="Settings_filesList__LJdJd",I="Settings_scriptCode__72b-w",D="Settings_buttonsWrapper__QHHgf",R="Settings_dragndropMessage__I6pO6",T=r(184),E=(0,d.Pi)((function(){var e,t,r=(0,c.useState)(),d=(0,a.Z)(r,2),E=d[0],L=d[1],W=(0,c.useState)(""),H=(0,a.Z)(W,2),z=H[0],A=H[1],U=(0,c.useState)(""),F=(0,a.Z)(U,2),M=F[0],K=F[1],Y=(0,c.useState)(""),J=(0,a.Z)(Y,2),q=J[0],O=J[1],V=(0,c.useState)(""),Q=(0,a.Z)(V,2),$=Q[0],G=Q[1],X=(0,c.useState)("0"),ee=(0,a.Z)(X,2),te=ee[0],re=ee[1],ne=(0,c.useState)(""),ie=(0,a.Z)(ne,2),se=ie[0],oe=ie[1],ae=(0,c.useState)("0"),ce=(0,a.Z)(ae,2),de=ce[0],le=ce[1],ue=(0,c.useState)([]),pe=(0,a.Z)(ue,2),je=pe[0],ge=pe[1],ve=(0,c.useState)(""),he=(0,a.Z)(ve,2),xe=he[0],fe=he[1],_e=(0,c.useRef)(null),me=j.ZP.user,we=me._id,Pe=me.getProjectById,Ne=me.saveProjectSettings,Ce=me.ingestKnowledgeBase,be=j.ZP.interface,Se=be.isLoading,ke=be.spinnerMessage,Ze=be.currentProjectId,Be=be.setSpinnerMessage,ye=be.pushNotification,Ie=be.setIsLoading,De=be.setModalType;(0,c.useEffect)((function(){if(!Se){var e=Pe(Ze);if(e){var t=e.projectName,r=e.projectURL,n=e.widgetSettings,i=n.widgetHeaderColor,s=n.widgetBackgroundColor,o=n.widgetBorderColor,a=n.widgetBorderWidth,c=n.widgetBorderRadius;L(e),A(t||""),K(r||""),O(i||""),G(s||""),oe(o||""),le(a||""),re(c||"")}}}),[Se,Ze]);var Re=function(){return'   <script\n    id="clarify_bot_widget"\n    data-userId="'.concat(we,'"\n    data-projectId="').concat(Ze,'"\n    src="').concat(j._n,"/widget/getWidget?projectId=").concat(Ze,'"\n    data-backendURL="').concat(j._n,'"\n   ><\/script>')},Te=function(e){return function(t){switch(e){case"projectName":A(t.target.value);break;case"projectURL":K(t.target.value);break;case"widgetHeaderColor":O(t.target.value);break;case"widgetBackgroundColor":G(t.target.value);break;case"widgetBorderColor":oe(t.target.value);break;case"widgetBorderWidth":le(t.target.value);break;case"widgetBorderRadius":re(t.target.value)}}},Ee=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,p.f)(z)?(0,p.r)(M)||(fe("projectURLError"),0):(fe("projectNameError"),0)){e.next=2;break}return e.abrupt("return");case 2:return fe(""),t=(0,s.Z)((0,s.Z)({},E),{},{projectName:z,projectURL:M}),Ie(!0),Be("Updating project metadata..."),e.next=8,Ne(t);case 8:Ie(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Le=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ie(!0),Be("Updating widget settings..."),t=(0,s.Z)((0,s.Z)({},E),{},{widgetSettings:{widgetHeaderColor:q,widgetBackgroundColor:$,widgetBorderRadius:te,widgetBorderColor:se,widgetBorderWidth:de}}),e.next=5,Ne(t);case 5:Ie(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),We=function(e){e.preventDefault(),e.stopPropagation(),console.log("handleFilesAdd");try{for(var t,r="drop"===e.type?e.dataTransfer.files:e.target.files,i=(0,n.Z)(je),s=0;s<r.length;s+=1)"text/plain"===r[s].type&&i.push(r[s]);ge(i),null!==_e&&void 0!==_e&&null!==(t=_e.current)&&void 0!==t&&t.value&&(_e.current.value="")}catch(xe){ye({type:"error",message:"Error while loading files from local drive. \n"+xe.message})}},He=function(){ge([])},ze=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ie(!0),Be("Ingesting knowledge base"),t=new FormData,je.forEach((function(e){t.append("dataFiles",e)})),t.append("projectId",(null===E||void 0===E?void 0:E._id)||""),t.append("projectName",(null===E||void 0===E?void 0:E.projectName)||""),e.next=8,Ce(t);case 8:He();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return E?(0,T.jsxs)("div",{className:g,children:[(0,T.jsx)("div",{className:h,children:(0,T.jsx)(l.rU,{to:"/cabinet/projects",style:{display:"block",width:"fit-content"},children:(0,T.jsx)(u.zx,{icon:"icon_arrow_left",text:"To projects list"})})}),(0,T.jsxs)("div",{className:v,children:[(0,T.jsxs)("div",{className:x,children:[(0,T.jsxs)("div",{className:f,children:[(0,T.jsx)("h2",{children:"Widget settings"}),(0,T.jsx)(u.zx,{disabled:Se,text:"Discard",icon:"icon_close",onClick:function(){if(E){var e=E.widgetSettings;O((null===e||void 0===e?void 0:e.widgetHeaderColor)||""),G((null===e||void 0===e?void 0:e.widgetBackgroundColor)||""),oe((null===e||void 0===e?void 0:e.widgetBorderColor)||""),le((null===e||void 0===e?void 0:e.widgetBorderWidth)||""),re((null===e||void 0===e?void 0:e.widgetBorderRadius)||"")}}}),(0,T.jsx)(u.zx,{disabled:Se,text:"Save",icon:"icon_save",onClick:Le})]}),(0,T.jsxs)("div",{className:_+" "+m,children:[(0,T.jsxs)("div",{className:w,children:[" ",(0,T.jsxs)("label",{className:P,children:["Header color",(0,T.jsx)("input",{type:"color",value:q,onChange:Te("widgetHeaderColor")})]}),(0,T.jsxs)("label",{className:P,children:["Background color",(0,T.jsx)("input",{type:"color",value:$,onChange:Te("widgetBackgroundColor")})]}),(0,T.jsxs)("label",{className:P,children:["Border color",(0,T.jsx)("input",{type:"color",value:se,onChange:Te("widgetBorderColor")})]}),(0,T.jsxs)("label",{className:N,children:["Border width, px",(0,T.jsx)("input",{type:"range",min:0,max:6,value:de,onChange:Te("widgetBorderWidth")})]}),(0,T.jsxs)("label",{className:N,children:["Border radius, px",(0,T.jsx)("input",{type:"range",min:0,max:30,value:te,onChange:Te("widgetBorderRadius")})]})]}),(0,T.jsx)("div",{className:C,children:(0,T.jsx)(u.e4,{settings:{projectId:Ze,widgetHeaderColor:q,widgetBackgroundColor:$,widgetBorderRadius:te,widgetBorderColor:se,widgetBorderWidth:de}})})]})]}),(0,T.jsxs)("div",{className:x,children:[(0,T.jsxs)("div",{className:f,children:[(0,T.jsx)("h2",{children:"Knowledge base"}),(0,T.jsxs)("div",{className:D,children:[(0,T.jsx)(u.zx,{disabled:Se||!je.length,text:"Ingest",icon:"icon_edit",onClick:ze}),(0,T.jsx)(u.zx,{disabled:Se||!(null!==E&&void 0!==E&&null!==(e=E.projectIngestedData)&&void 0!==e&&e.length),text:"Delete",icon:"icon_delete",onClick:function(){Be("Deleting knowledge base"),De("proejctKBDelete"),He()}})]})]}),(0,T.jsxs)("div",{className:_+" "+b,children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{children:"List of knowledgebase files"}),(0,T.jsx)("div",{className:Z,children:(0,T.jsx)("ul",{className:y,children:null===E||void 0===E||null===(t=E.projectIngestedData)||void 0===t?void 0:t.map((function(e){var t=e.fileName,r=e.size;return(0,T.jsxs)("li",{children:[(0,T.jsx)("span",{children:t}),(0,T.jsxs)("span",{children:[Number.parseFloat(r||"").toFixed(2)," kb"]})]},t)}))})})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:S,children:[(0,T.jsx)("span",{children:"Files to ingest"}),null!==je&&void 0!==je&&je.length?(0,T.jsx)("span",{className:k,onClick:He,children:"Clear list"}):null]}),(0,T.jsx)("input",{ref:_e,type:"file",accept:".txt",multiple:!0,onChange:We}),(0,T.jsx)("div",{className:B,onDragOver:function(e){return e.preventDefault()},onDrop:We,onClick:function(){var e;return null===_e||void 0===_e||null===(e=_e.current)||void 0===e?void 0:e.click()},children:null!==je&&void 0!==je&&je.length?(0,T.jsx)("ul",{className:y,children:Array.from(je).map((function(e){var t=e.name,r=e.size;return(0,T.jsxs)("li",{children:[(0,T.jsx)("span",{children:t}),(0,T.jsx)("span",{children:"".concat(r/1e3," kb")})]},t+r)}))}):(0,T.jsx)("div",{className:R,children:"Drag'n'drop txt files or click Add files button. Files are adding up to the ones that are already in knowledge base."})})]})]})]})," ",(0,T.jsxs)("div",{className:x,children:[(0,T.jsxs)("div",{className:f,children:[(0,T.jsx)("h2",{children:"Metadata"}),(0,T.jsx)(u.zx,{disabled:Se,text:"Discard",icon:"icon_close",onClick:function(){A((null===E||void 0===E?void 0:E.projectName)||""),K((null===E||void 0===E?void 0:E.projectURL)||"")}}),(0,T.jsx)(u.zx,{disabled:Se,text:"Save",icon:"icon_save",onClick:Ee})]}),(0,T.jsxs)("div",{className:_,children:[(0,T.jsxs)("label",{children:["Project name",(0,T.jsx)("span",{className:"hintText",children:"leters, numbers, dashes are allowed"}),(0,T.jsx)("input",{type:"text",className:"projectNameError"===xe?"error":"",placeholder:"project-name",value:z,onChange:Te("projectName")})]}),(0,T.jsxs)("label",{children:["Project URL for the widget usage",(0,T.jsx)("input",{type:"url",className:"projectURLError"===xe?"error":"",placeholder:"https://example.com",value:M,onChange:Te("projectURL")})]})]})]}),(0,T.jsxs)("div",{className:x,children:[(0,T.jsxs)("div",{className:f,children:[(0,T.jsx)("h2",{children:"Client script"}),(0,T.jsx)(u.zx,{disabled:Se,text:"Copy",icon:"icon_copy",onClick:function(){window.navigator.clipboard.writeText(Re()).then((function(){return ye({type:"info",message:"Script copied to clipboard."})}))}})]}),(0,T.jsxs)("div",{className:_,children:[(0,T.jsx)("code",{className:I,children:Re()})," "]})]}),Se?(0,T.jsx)(u.$j,{text:ke}):null]})]}):(0,T.jsx)("div",{children:"Project not found."})}))},1895:function(e,t,r){r.r(t),r.d(t,{Billing:function(){return x.default},Projects:function(){return h.default},Settings:function(){return f.default},Stats:function(){return _},default:function(){return v}});var n=r(2791),i=r(7257),s=r(4880),o=r(7837),a=r(1603),c="Cabinet_projectTitle__mdMBP",d="Cabinet_projectName__zYEFB",l="Cabinet_projectId__6NzER",u=r(184),p=(0,n.lazy)((function(){return Promise.resolve().then(r.bind(r,7797))})),j=(0,n.lazy)((function(){return Promise.resolve().then(r.bind(r,4128))})),g=(0,n.lazy)((function(){return Promise.resolve().then(r.bind(r,4054))})),v=(0,i.Pi)((function(){var e,t,r=(0,s.$B)().url,i=(0,s.TH)().pathname,v=a.ZP.interface,h=v.currentProjectId,x=v.isLoading,f=(0,a.ZP.user.getProjectById)(h);return(0,n.useEffect)((function(){}),[x]),(0,u.jsx)("div",{className:"page",children:(0,u.jsxs)("div",{className:"pageContent",children:[f?(0,u.jsxs)("div",{className:c,children:[(0,u.jsxs)("h1",{className:d,children:["Project name : "+f.projectName,(0,u.jsx)(o.tU,{isActive:null===(e=f.subscription)||void 0===e?void 0:e.isActive,stripeMode:null===(t=f.subscription)||void 0===t?void 0:t.stripeMode})]}),(0,u.jsx)("span",{className:l,children:"Project id : "+f._id})]}):null,(0,u.jsx)(n.Suspense,{fallback:(0,u.jsx)(o.$j,{}),children:(0,u.jsxs)(s.rs,{children:[(0,u.jsx)(s.l_,{from:"/:url*(/+)",to:i.slice(0,-1)})," ",(0,u.jsx)(s.AW,{path:"".concat(r,"/projects"),component:p}),(0,u.jsx)(s.AW,{path:"".concat(r,"/billing"),component:j}),(0,u.jsx)(s.AW,{path:"".concat(r,"/settings"),component:g}),(0,u.jsx)(s.l_,{to:"".concat(r,"/projects")})," "]})})]})})})),h=r(7797),x=r(4128),f=r(4054),_=function(){return(0,u.jsx)("div",{children:"Stats."})}}}]);
//# sourceMappingURL=Cabinet.0ac2cf03.chunk.js.map
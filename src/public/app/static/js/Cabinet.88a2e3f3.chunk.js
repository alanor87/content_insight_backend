"use strict";(self.webpackChunkcontent_insight_frontend=self.webpackChunkcontent_insight_frontend||[]).push([[595],{4128:function(e,t,r){r.r(t),r.d(t,{default:function(){return m}});var n=r(885),s=r(4165),i=r(5861),a=r(2791),o=r(7257),c=r(4880),d=r(3473),l=r(5764),u=r(1603),p="Billing_checkoutResultMessage__HI5wo",j=r(1243),g=r(184),h=(0,d.J)("pk_test_51Nxd5pEafHQOYw4BGVCREVAXfGdqJ1waIwTd9TT9cWrP1dI8b9rkgaTV25WSRbVGzQFx9YcYDubV8WGF1Y0zNKYf00E2dA3E0t"),x=function(){var e=u.Z.user.userStripeCustomerId,t=function(){var t=(0,i.Z)((0,s.Z)().mark((function t(){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:j.Z.post(u._+"/user/customerPortal",{userStripeCustomerId:e});case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,g.jsxs)("div",{children:["User is registered in Stripe."," ",(0,g.jsx)("button",{type:"button",onClick:t,children:"Manage Billing"})]})},f=function(){var e=u.Z.user.createSubscription,t=u.Z.interface.currentProjectId,r=(0,a.useState)(""),s=(0,n.Z)(r,2),i=s[0],o=s[1];(0,a.useEffect)((function(){e(t).then((function(e){return o(e)}))}),[]);var c={clientSecret:i};return(0,g.jsx)("div",{id:"checkout",children:i&&(0,g.jsx)(l.EmbeddedCheckoutProvider,{stripe:h,options:c,children:(0,g.jsx)(l.EmbeddedCheckout,{})})})},v=function(){var e,t=(0,a.useState)(),r=(0,n.Z)(t,2),s=r[0],i=r[1],o=u.Z.user,d=o.getPaymentSessionStatus,l=o.getProjectById,j=u.Z.interface,h=j.currentProjectId,x=j.setCurrentProjectId,f=(0,c.TH)().search;return(0,a.useEffect)((function(){if(f){var e=new URLSearchParams(f),t=e.get("session_id"),r=e.get("projectId");if(!t||!r)return;d({session_id:t,projectId:r}).then((function(e){if(i(e),x(r||""),"complete"===e.status){var t=l(r);null===t||void 0===t||t.setProjectIsActive(!0)}}))}}),[f]),s?(0,g.jsxs)("div",{className:p,children:["Checkout result for project :",(0,g.jsxs)("p",{children:["Project name : ",null===(e=l(h))||void 0===e?void 0:e.projectName]}),(0,g.jsxs)("p",{children:["Project id : ",h]}),(0,g.jsxs)("p",{children:["Result :","complete"===s.status?"Payment successful":"Payment failed"]})]}):null},m=(0,o.Pi)((function(){var e=(0,c.$B)().path,t=u.Z.user.userStripeCustomerId;return(0,g.jsxs)(c.rs,{children:[(0,g.jsx)(c.AW,{exact:!0,path:e,component:t?x:f}),(0,g.jsx)(c.AW,{path:"".concat(e,"/checkoutResult"),component:v})]})}))},7797:function(e,t,r){r.r(t),r.d(t,{default:function(){return N}});var n=r(8683),s=r(7257),i=r(7837),a=r(4880),o=r(5146),c=r(1603),d="ProjectTile_projectTile__quj6f",l="ProjectTile_projectDetails__grJt9",u="ProjectTile_wrapper__v8hyE",p="ProjectTile_projectName__zn2aT",j="ProjectTile_projectDetailField__Y9KxJ",g="ProjectTile_projectControls__P+4YV",h=r(1374),x=r(184),f=(0,s.Pi)((function(e){var t=e._id,r=e.projectName,n=e.projectCreationDate,s=e.projectURL,i=e.subscription,f=e.onDelete,v=(0,a.k6)(),m=new Date(n||"").toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),_=c.Z.interface.setCurrentProjectId;return(0,x.jsxs)("div",{className:d,children:[(0,x.jsx)("div",{className:l,onClick:function(){_(t||""),v.replace("/cabinet/settings")},children:(0,x.jsxs)("div",{className:u,children:[(0,x.jsxs)("div",{className:p,children:[r,(0,x.jsx)(h.Z,{isActive:!(null===i||void 0===i||!i.isActive)})]}),(0,x.jsxs)("div",{className:j,children:["URL: ",s]}),(0,x.jsxs)("div",{className:j,children:["Created: ",m]})]})}),(0,x.jsx)("div",{className:g,children:(0,x.jsx)(o.Z,{icon:"icon_delete",text:"Delete project",onClick:function(e){f(t||"")}})})]})})),v="Projects_projectsContainer__-CySH",m="Projects_addProjectButton__lsD59",_="Projects_projectTilesWrapper__ha7Uj",w=r(2791),N=(0,s.Pi)((function(){var e=c.Z.user.userProjects,t=c.Z.interface,r=t.setModalType,s=t.setCurrentProjectId,a=t.setDeleteProjectId,o=t.isLoading;(0,w.useEffect)((function(){return s("")}),[]);var d=function(e){a(e),r("projectDelete")};return(0,x.jsxs)("div",{className:v,children:[(0,x.jsx)(i.zx,{icon:"icon_plus",text:"Add project",className:m,onClick:function(){r("projectCreate")}}),(0,x.jsx)("div",{className:_,children:e.length?e.map((function(e){return(0,x.jsx)(f,(0,n.Z)((0,n.Z)({},e),{},{onDelete:d}),e._id)})):"You dont have any projects yet."}),o?(0,x.jsx)(i.$j,{}):null]})}))},4054:function(e,t,r){r.r(t),r.d(t,{default:function(){return R}});var n=r(2982),s=r(4165),i=r(8683),a=r(5861),o=r(885),c=r(2791),d=r(7257),l=r(1523),u=r(7837),p=r(4193),j=r(1603),g="Settings_projectPageWrapper__x8BfJ",h="Settings_projectPage__1LYim",x="Settings_projectHeader__MfVop",f="Settings_projectPageSection__HZoTz",v="Settings_sectionHeader__7Fv+K",m="Settings_sectionContent__mfMiW",_="Settings_widgetSettings__3ZVDl",w="Settings_widgetControls__SxOnQ",N="Settings_color__oSXPk",b="Settings_range__nDO0q",C="Settings_demoWidgetWrapper__dASOJ",k="Settings_knowledgeBase__rYB0Z",S="Settings_knowledgeBaseList__pqKmI",P="Settings_knowledgeBaseUploadForm__roudD",Z="Settings_filesList__LJdJd",B="Settings_scriptCode__72b-w",y="Settings_buttonsWrapper__QHHgf",I="Settings_dragndropMessage__I6pO6",D=r(184),R=(0,d.Pi)((function(){var e,t,r=(0,c.useState)(),d=(0,o.Z)(r,2),R=d[0],T=d[1],W=(0,c.useState)(""),z=(0,o.Z)(W,2),E=z[0],L=z[1],U=(0,c.useState)(""),A=(0,o.Z)(U,2),H=A[0],F=A[1],M=(0,c.useState)(""),Y=(0,o.Z)(M,2),J=Y[0],V=Y[1],K=(0,c.useState)(""),O=(0,o.Z)(K,2),$=O[0],q=O[1],G=(0,c.useState)("0"),Q=(0,o.Z)(G,2),X=Q[0],ee=Q[1],te=(0,c.useState)(""),re=(0,o.Z)(te,2),ne=re[0],se=re[1],ie=(0,c.useState)("0"),ae=(0,o.Z)(ie,2),oe=ae[0],ce=ae[1],de=(0,c.useState)([]),le=(0,o.Z)(de,2),ue=le[0],pe=le[1],je=(0,c.useState)(""),ge=(0,o.Z)(je,2),he=ge[0],xe=ge[1],fe=j.Z.user,ve=fe._id,me=fe.getProjectById,_e=fe.saveProjectSettings,we=fe.ingestKnowledgeBase,Ne=j.Z.interface,be=Ne.isLoading,Ce=Ne.spinnerMessage,ke=Ne.currentProjectId,Se=Ne.setSpinnerMessage,Pe=Ne.pushNotification,Ze=Ne.setIsLoading,Be=Ne.setModalType;(0,c.useEffect)((function(){var e=me(ke);if(e){var t=e.projectName,r=e.projectURL,n=e.widgetSettings,s=n.widgetHeaderColor,i=n.widgetBackgroundColor,a=n.widgetBorderColor,o=n.widgetBorderWidth,c=n.widgetBorderRadius;T(e),L(t||""),F(r||""),V(s||""),q(i||""),se(a||""),ce(o||""),ee(c||"")}}),[]);var ye=function(){return'   <script\n    id="clarify_bot_widget"\n    data-userId="'.concat(ve,'"\n    data-projectId="').concat(ke,'"\n    src="https://content-insight-backend-c244a3d2147a.herokuapp.com/widget/getWidget"\n    data-backendURL="https://content-insight-backend-c244a3d2147a.herokuapp.com"\n   ><\/script>')},Ie=function(e){return function(t){switch(e){case"projectName":L(t.target.value);break;case"projectURL":F(t.target.value);break;case"widgetHeaderColor":V(t.target.value);break;case"widgetBackgroundColor":q(t.target.value);break;case"widgetBorderColor":se(t.target.value);break;case"widgetBorderWidth":ce(t.target.value);break;case"widgetBorderRadius":ee(t.target.value)}}},De=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,p.f)(E)?(0,p.r)(H)||(xe("projectURLError"),0):(xe("projectNameError"),0)){e.next=2;break}return e.abrupt("return");case 2:return xe(""),t=(0,i.Z)((0,i.Z)({},R),{},{projectName:E,projectURL:H}),Ze(!0),Se("Updating project metadata..."),e.next=8,_e(t);case 8:Ze(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Re=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ze(!0),Se("Updating widget settings..."),t=(0,i.Z)((0,i.Z)({},R),{},{widgetSettings:{widgetHeaderColor:J,widgetBackgroundColor:$,widgetBorderRadius:X,widgetBorderColor:ne,widgetBorderWidth:oe}}),e.next=5,_e(t);case 5:Ze(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Te=function(e){console.log("handleFilesAdd"),e.preventDefault(),e.stopPropagation();try{for(var t="drop"===e.type?e.dataTransfer.files:e.target.files,r=(0,n.Z)(ue),s=0;s<t.length;s+=1)"text/plain"===t[s].type&&r.push(t[s]);pe(r)}catch(he){Pe({type:"error",message:"Error while loading files from local drive. \n"+he.message})}},We=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ze(!0),Se("Ingesting knowledge base"),t=new FormData,ue.forEach((function(e){t.append("dataFiles",e)})),t.append("projectId",(null===R||void 0===R?void 0:R._id)||""),t.append("projectName",(null===R||void 0===R?void 0:R.projectName)||""),e.next=8,we(t);case 8:pe([]);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return R?(0,D.jsxs)("div",{className:g,children:[(0,D.jsx)("div",{className:x,children:(0,D.jsx)(l.rU,{to:"/cabinet/projects",style:{display:"block",width:"fit-content"},children:(0,D.jsx)(u.zx,{icon:"icon_arrow_left",text:"To projects list"})})}),(0,D.jsxs)("div",{className:h,children:[(0,D.jsxs)("div",{className:f,children:[(0,D.jsxs)("div",{className:v,children:[(0,D.jsx)("h2",{children:"Widget settings"}),(0,D.jsx)(u.zx,{disabled:be,text:"Discard",icon:"icon_close",onClick:function(){if(R){var e=R.widgetSettings;V((null===e||void 0===e?void 0:e.widgetHeaderColor)||""),q((null===e||void 0===e?void 0:e.widgetBackgroundColor)||""),se((null===e||void 0===e?void 0:e.widgetBorderColor)||""),ce((null===e||void 0===e?void 0:e.widgetBorderWidth)||""),ee((null===e||void 0===e?void 0:e.widgetBorderRadius)||"")}}}),(0,D.jsx)(u.zx,{disabled:be,text:"Save",icon:"icon_save",onClick:Re})]}),(0,D.jsxs)("div",{className:m+" "+_,children:[(0,D.jsxs)("div",{className:w,children:[" ",(0,D.jsxs)("label",{className:N,children:["Header color",(0,D.jsx)("input",{type:"color",value:J,onChange:Ie("widgetHeaderColor")})]}),(0,D.jsxs)("label",{className:N,children:["Background color",(0,D.jsx)("input",{type:"color",value:$,onChange:Ie("widgetBackgroundColor")})]}),(0,D.jsxs)("label",{className:N,children:["Border color",(0,D.jsx)("input",{type:"color",value:ne,onChange:Ie("widgetBorderColor")})]}),(0,D.jsxs)("label",{className:b,children:["Border width, px",(0,D.jsx)("input",{type:"range",min:0,max:6,value:oe,onChange:Ie("widgetBorderWidth")})]}),(0,D.jsxs)("label",{className:b,children:["Border radius, px",(0,D.jsx)("input",{type:"range",min:0,max:30,value:X,onChange:Ie("widgetBorderRadius")})]})]}),(0,D.jsx)("div",{className:C,children:(0,D.jsx)(u.e4,{settings:{projectId:ke,widgetHeaderColor:J,widgetBackgroundColor:$,widgetBorderRadius:X,widgetBorderColor:ne,widgetBorderWidth:oe}})})]})]}),(0,D.jsxs)("div",{className:f,children:[(0,D.jsxs)("div",{className:v,children:[(0,D.jsx)("h2",{children:"Knowledge base"}),(0,D.jsxs)("div",{className:y,children:[(0,D.jsx)(u.zx,{disabled:be||!ue.length,text:"Ingest",icon:"icon_edit",onClick:We}),(0,D.jsx)(u.zx,{disabled:be||!(null!==R&&void 0!==R&&null!==(e=R.projectIngestedData)&&void 0!==e&&e.length),text:"Delete",icon:"icon_delete",onClick:function(){Se("Deleting knowledge base"),Be("proejctKBDelete"),pe([])}})]})]}),(0,D.jsxs)("div",{className:m+" "+k,children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{children:"List of knowledgebase files"}),(0,D.jsx)("div",{className:S,children:(0,D.jsx)("ul",{className:Z,children:null===R||void 0===R||null===(t=R.projectIngestedData)||void 0===t?void 0:t.map((function(e){var t=e.fileName,r=e.size;return(0,D.jsxs)("li",{children:[(0,D.jsx)("span",{children:t}),(0,D.jsxs)("span",{children:[Number.parseFloat(r||"").toFixed(2)," kb"]})]},t)}))})})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{children:"Ingest files"}),(0,D.jsxs)("div",{className:P,onDragOver:function(e){e.preventDefault(),e.stopPropagation()},children:[" ",(0,D.jsx)("input",{title:"files to upload",type:"file",accept:".txt",multiple:!0,onDragEnd:Te,onChange:Te}),null!==ue&&void 0!==ue&&ue.length?(0,D.jsx)("ul",{className:Z,children:Array.from(ue).map((function(e){var t=e.name,r=e.size;return(0,D.jsxs)("li",{children:[(0,D.jsx)("span",{children:t}),(0,D.jsx)("span",{children:r})]},t+r)}))}):(0,D.jsx)("div",{className:I,children:"Drag'n'drop txt files or click the area for dialog window. Files are adding up to the ones that are already in knowledge base."})]})]})]})]})," ",(0,D.jsxs)("div",{className:f,children:[(0,D.jsxs)("div",{className:v,children:[(0,D.jsx)("h2",{children:"Metadata"}),(0,D.jsx)(u.zx,{disabled:be,text:"Discard",icon:"icon_close",onClick:function(){L((null===R||void 0===R?void 0:R.projectName)||""),F((null===R||void 0===R?void 0:R.projectURL)||"")}}),(0,D.jsx)(u.zx,{disabled:be,text:"Save",icon:"icon_save",onClick:De})]}),(0,D.jsxs)("div",{className:m,children:[(0,D.jsxs)("label",{children:["Project name",(0,D.jsx)("span",{className:"hintText",children:"leters, numbers, dashes are allowed"}),(0,D.jsx)("input",{type:"text",className:"projectNameError"===he?"error":"",placeholder:"project-name",value:E,onChange:Ie("projectName")})]}),(0,D.jsxs)("label",{children:["Project URL for the widget usage",(0,D.jsx)("input",{type:"url",className:"projectURLError"===he?"error":"",placeholder:"https://example.com",value:H,onChange:Ie("projectURL")})]})]})]}),(0,D.jsxs)("div",{className:f,children:[(0,D.jsxs)("div",{className:v,children:[(0,D.jsx)("h2",{children:"Client script"}),(0,D.jsx)(u.zx,{disabled:be,text:"Copy",icon:"icon_copy",onClick:function(){window.navigator.clipboard.writeText(ye()).then((function(){return Pe({type:"info",message:"Script copied to clipboard."})}))}})]}),(0,D.jsxs)("div",{className:m,children:[(0,D.jsx)("code",{className:B,children:ye()})," "]})]}),be?(0,D.jsx)(u.$j,{text:Ce}):null]})]}):(0,D.jsx)("div",{children:"Project not found."})}))},346:function(e,t,r){r.r(t),r.d(t,{default:function(){return s}});var n=r(184),s=function(){return(0,n.jsx)("div",{children:"Stats."})}},266:function(e,t,r){r.r(t),r.d(t,{Billing:function(){return m.default},Projects:function(){return v.default},Settings:function(){return _.default},Stats:function(){return w.default},default:function(){return f}});var n=r(885),s=r(2791),i=r(7257),a=r(4880),o=r(7837),c=r(1603),d="Cabinet_projectTitle__mdMBP",l="Cabinet_projectName__zYEFB",u="Cabinet_projectId__6NzER",p=r(184),j=(0,s.lazy)((function(){return Promise.resolve().then(r.bind(r,7797))})),g=(0,s.lazy)((function(){return Promise.resolve().then(r.bind(r,4128))})),h=(0,s.lazy)((function(){return Promise.resolve().then(r.bind(r,4054))})),x=(0,s.lazy)((function(){return Promise.resolve().then(r.bind(r,346))})),f=(0,i.Pi)((function(){var e,t=(0,a.$B)().url,r=(0,a.TH)().pathname,i=c.Z.interface.currentProjectId,f=c.Z.user.getProjectById,v=(0,s.useState)(),m=(0,n.Z)(v,2),_=m[0],w=m[1];return(0,s.useEffect)((function(){w(f(i))}),[i]),(0,p.jsx)("div",{className:"page",children:(0,p.jsxs)("div",{className:"pageContent",children:[_?(0,p.jsxs)("div",{className:d,children:[(0,p.jsxs)("h1",{className:l,children:["Project name : "+_.projectName,(0,p.jsx)(o.tU,{isActive:!(null===(e=_.subscription)||void 0===e||!e.isActive)})]}),(0,p.jsx)("span",{className:u,children:"Project id : "+_._id})]}):null,(0,p.jsx)(s.Suspense,{fallback:(0,p.jsx)(o.$j,{}),children:(0,p.jsxs)(a.rs,{children:[(0,p.jsx)(a.l_,{from:"/:url*(/+)",to:r.slice(0,-1)})," ",(0,p.jsx)(a.AW,{path:"".concat(t,"/projects"),component:j}),(0,p.jsx)(a.AW,{path:"".concat(t,"/stats"),component:x}),(0,p.jsx)(a.AW,{path:"".concat(t,"/billing"),component:g}),(0,p.jsx)(a.AW,{path:"".concat(t,"/settings"),component:h}),(0,p.jsx)(a.l_,{to:"".concat(t,"/projects")})," "]})})]})})})),v=r(7797),m=r(4128),_=r(4054),w=r(346)}}]);
//# sourceMappingURL=Cabinet.88a2e3f3.chunk.js.map